# 马尔可夫性

## 标准定义

设 **{X(t), t∊T}** 为一随机过程，**E** 为其状态空间，若对任意的 **t₁ < t₂ < ... < t𝔫 < t**，任意的 **𝒳₁, 𝒳₂, ..., 𝒳𝔫, 𝒳∊E**，随机变量 **X(t)** 在已知变量 **X(t₁) = 𝒳₁, ..., X(t𝘯) = 𝒳𝘯** 之下的条件分布函数只与 **X(t𝔫) = 𝒳𝔫** 有关，而与 **X(t₁) = 𝒳₁, ..., X(t𝔫₋₁) = 𝒳𝔫₋₁** 无关，即条件分布函数满足等式    


**F(𝒳,t|𝒳𝘯,t𝘯) = F(𝒳,t|𝒳𝘯, 𝒳𝔫₋₁,..,𝒳₁,t𝔫,t𝔫₋₁,...,t₁)**  



即  

**P(X(t)=𝒳|X(t𝔫)=𝒳𝔫) = P(X(t)=𝒳|X(t𝔫)=𝒳𝔫,X(t𝔫₋₁) = 𝒳𝘯₋₁,...,X(t₁)=𝒳₁)**    

此性质称为马尔可夫性，亦称无后效性或无记忆性。 


## 通俗描述

> 指系统的下一个状态 St+1，只与当前壮状态 St 有关，而与以前的状态无关。

实际上，当前状态 St 中已经蕴含了过往历史状态的信息了，所以，一旦当前状态已知，历史信息就可以抛弃了。


# 马尔可夫过程

马科夫过程是一个 **二元组（S，P）**。其中，**S** 表示有限的状态集合，**P** 表示对应的状态转移概率。

![](https://raw.githubusercontent.com/chenBingX/img/master/机器学习相关/马尔可夫过程.png)  

上图就是是一个 **马尔可夫过程** 示意图。

# 马尔可夫链

马尔可夫链，就是指具有 **马尔可夫性** 的且存在与 **离散指数集** 和 **状态空间** 内的 **随机过程**。  



上图中，存在状态空间集合 **{S₁, S₂, S₃}**，则有状态序列：

- S₁ → S₁

- S₁ → S₂ → S₃

- S₁ → S₂ → S₃ → S₂

- 。。。

这些状态序列，就称为 **马尔可夫链**。



# 马尔可夫决策过程（Markov Decision Process, MDP）

单纯的 **马尔可夫过程** 只存在 **状态空间** 和 **转移概率**。在一些场景中，如智能体，其与环境是有动作交互的，且能够通过交互获得环境奖励或者惩罚。

因此，在原有的 **马尔可夫过程** 中引入新的因素，可以动态的寻找具有 **马尔可夫性** 的随机系统的最优状态。  

马尔可夫决策过程，MDP，包含了5个要素 **[S(状态)，A(状态)，𝝅(策略，转移概率)，R(奖励函数)，𝜸(折扣因子，计算累计回报)]**。

|要素|符号|说明|
|--|--|--|
|状态(状态空间)|S={s₁,s₂,...,s𝘵}|状态是对环境的描述，智能体作出动作后，会从当前状态转移到下一状态|
|动作(动作空间)|A={a₁,a₂,...,a𝘵}|表示智能体的决策结果|
|策略(转移概率)|𝝅(a|s)=p(a|s)|表示动作的概率|
|奖励函数|R=R(s𝘵,a𝘵,s𝘵₊₁)|处于s𝘵状态下的智能体，给出动作后，环境给予智能体的反馈。状态将转移到下一状态|
|回报(折扣因子)|𝛾，𝛾∊[0,1] ，G𝘵=Σ𝛾ᵏR𝘵₊𝑘₊₁|表明未来回报相对于当前回报的重要程度。比如 𝛾=0，相当于只考了当前立即回报，不考虑长期回报。表示用于计算回报随时间步累积。|

MDP按如下方式进行组织：智能体对初始环境 s₀ 进行感知，按策略 𝝅₀ 实施动作 a₀，环境受动作影响进入新的状态 s₁，并反馈给智能体一个奖励 R(s₀,a₀,s₁)。随后智能体基于 s₁ 采取新的策略，与环境持续交互。


若有下图马尔可夫过程图：  


![](https://raw.githubusercontent.com/chenBingX/img/master/机器学习相关/马尔可夫过程2.png)

则其对应的转移概率矩阵为：  


![](https://raw.githubusercontent.com/chenBingX/img/master/机器学习相关/马尔可夫状态转移矩阵.png)



## 价值函数

> 定义：一个马尔可夫奖励过程中某一状态的 **价值函数** 为从该状态开始的马尔可夫链的收获的期望：  

**𝜈(s)=𝚬[G𝘵|S𝘵=s]**  

## Bellman方程

有上述 **状态价值函数**，将 **G𝘵** 展开，推导可得：  

**𝜈(s)=𝚬[R𝘵₊₁ + 𝛾𝜈(S𝘵₊₁)|S𝘵=s]**   

则表明，当前状态的值函数，与当前状态奖励和下一个状态的值函数有关。

因为 **R𝘴=𝚬[R𝘵₊₁|S𝘵=s]**，则有：    

**𝜈(s)=R𝘴 + 𝛾ΣP𝘴‘𝜈(𝘴‘)**   




# 隐马可夫模型

隐马可夫模型，用来描述一个含有隐含位置参数的马可夫过程。  

由定义不能看出，难点在于寻找可观测参数中确定观测过程中的隐含参数。  

![](http://ogemdlrap.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-10-03%20%E4%B8%8B%E5%8D%885.07.05.png)  

![](http://ogemdlrap.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-10-03%20%E4%B8%8B%E5%8D%885.07.13.png)  



